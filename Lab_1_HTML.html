<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>807e4c1da7e14534ad74ef55898a44e0</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      word-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<section id="lab-assignment-one-exploring-table-data" class="cell markdown">
<h1>Lab Assignment One: Exploring Table Data</h1>
</section>
<section id="data-visualization-of-stroke-prediction-dataset" class="cell markdown">
<h1>Data Visualization of Stroke Prediction Dataset</h1>
<p>According to the World Health Organization, stroke is the second leading cause of death in the world. The data was collected from a patient cohort and involved patients answering a number of questions regarding their medical history and other miscellaneous items.</p>
<p>The results of this prediction task would be of interest to many third party groups such as healthcare professionals in healthcare insurance companies, life insurance companies, medical researchers, and biomedical engineers. Potentially being capable of having insight into an individual's proneness to stroke would be a vital piece of information to the aforementioned parties in evaluating insurance premiums and life insurance valuations.</p>
<p>The question we pose as we attempt to visualize this dataset is how the presence of comorbidities correlate influence the incidence of stroke.</p>
</section>
<div class="cell code" data-execution_count="1">
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sb</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Numpy:&#39;</span>, np.__version__)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Pandas:&#39;</span>, pd.__version__)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Seaborn:&#39;</span>, sb.__version__)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">&#39;stroke.csv&#39;</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>df.head()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Numpy: 1.21.5
Pandas: 1.4.2
Seaborn: 0.11.2
</code></pre>
</div>
<div class="output execute_result" data-execution_count="1">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>gender</th>
      <th>age</th>
      <th>hypertension</th>
      <th>heart_disease</th>
      <th>ever_married</th>
      <th>work_type</th>
      <th>Residence_type</th>
      <th>avg_glucose_level</th>
      <th>bmi</th>
      <th>smoking_status</th>
      <th>stroke</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>9046</td>
      <td>Male</td>
      <td>67.0</td>
      <td>0</td>
      <td>1</td>
      <td>Yes</td>
      <td>Private</td>
      <td>Urban</td>
      <td>228.69</td>
      <td>36.6</td>
      <td>formerly smoked</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>51676</td>
      <td>Female</td>
      <td>61.0</td>
      <td>0</td>
      <td>0</td>
      <td>Yes</td>
      <td>Self-employed</td>
      <td>Rural</td>
      <td>202.21</td>
      <td>NaN</td>
      <td>never smoked</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>31112</td>
      <td>Male</td>
      <td>80.0</td>
      <td>0</td>
      <td>1</td>
      <td>Yes</td>
      <td>Private</td>
      <td>Rural</td>
      <td>105.92</td>
      <td>32.5</td>
      <td>never smoked</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>60182</td>
      <td>Female</td>
      <td>49.0</td>
      <td>0</td>
      <td>0</td>
      <td>Yes</td>
      <td>Private</td>
      <td>Urban</td>
      <td>171.23</td>
      <td>34.4</td>
      <td>smokes</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1665</td>
      <td>Female</td>
      <td>79.0</td>
      <td>1</td>
      <td>0</td>
      <td>Yes</td>
      <td>Self-employed</td>
      <td>Rural</td>
      <td>174.12</td>
      <td>24.0</td>
      <td>never smoked</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="2" data-scrolled="true">
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>df.describe()</span></code></pre></div>
<div class="output execute_result" data-execution_count="2">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>age</th>
      <th>hypertension</th>
      <th>heart_disease</th>
      <th>avg_glucose_level</th>
      <th>bmi</th>
      <th>stroke</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>5110.000000</td>
      <td>5110.000000</td>
      <td>5110.000000</td>
      <td>5110.000000</td>
      <td>5110.000000</td>
      <td>4909.000000</td>
      <td>5110.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>36517.829354</td>
      <td>43.226614</td>
      <td>0.097456</td>
      <td>0.054012</td>
      <td>106.147677</td>
      <td>28.893237</td>
      <td>0.048728</td>
    </tr>
    <tr>
      <th>std</th>
      <td>21161.721625</td>
      <td>22.612647</td>
      <td>0.296607</td>
      <td>0.226063</td>
      <td>45.283560</td>
      <td>7.854067</td>
      <td>0.215320</td>
    </tr>
    <tr>
      <th>min</th>
      <td>67.000000</td>
      <td>0.080000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>55.120000</td>
      <td>10.300000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>17741.250000</td>
      <td>25.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>77.245000</td>
      <td>23.500000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>36932.000000</td>
      <td>45.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>91.885000</td>
      <td>28.100000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>54682.000000</td>
      <td>61.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>114.090000</td>
      <td>33.100000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>72940.000000</td>
      <td>82.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>271.740000</td>
      <td>97.600000</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<section id="data-understanding" class="cell markdown">
<h2>Data Understanding</h2>
<p>This is a retrospective analysis using data visualization of 11 patient features in an effort to predict the likelihood of stroke. The clinical features are gender, age, hypertension, heart disease, average glucose, body mass index, smoking history, and stroke history. Other features included are marriage history, work history, and residential area.</p>
</section>
<div class="cell code" data-execution_count="3" data-scrolled="false">
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.dtypes)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>id                     int64
gender                object
age                  float64
hypertension           int64
heart_disease          int64
ever_married          object
work_type             object
Residence_type        object
avg_glucose_level    float64
bmi                  float64
smoking_status        object
stroke                 int64
dtype: object
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="4">
<div class="sourceCode" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>df.ever_married.replace(to_replace <span class="op">=</span> [<span class="st">&#39;No&#39;</span>, <span class="st">&#39;Yes&#39;</span>], value <span class="op">=</span> <span class="bu">range</span>(<span class="dv">0</span>,<span class="dv">2</span>), inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>df.work_type.replace(to_replace <span class="op">=</span> [<span class="st">&#39;Private&#39;</span>, <span class="st">&#39;Self-employed&#39;</span>, <span class="st">&#39;Govt_job&#39;</span>], value <span class="op">=</span> <span class="bu">range</span>(<span class="dv">0</span>,<span class="dv">3</span>), inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>df.Residence_type.replace(to_replace <span class="op">=</span> [<span class="st">&#39;Rural&#39;</span>, <span class="st">&#39;Urban&#39;</span>], value <span class="op">=</span> <span class="bu">range</span>(<span class="dv">0</span>,<span class="dv">2</span>), inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>df.smoking_status.replace(to_replace <span class="op">=</span> [<span class="st">&#39;never smoked&#39;</span>, <span class="st">&#39;formerly smoked&#39;</span>, <span class="st">&#39;smokes&#39;</span>, <span class="st">&#39;Unknown&#39;</span>], value <span class="op">=</span> <span class="bu">range</span>(<span class="dv">0</span>,<span class="dv">4</span>), inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>df.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="4">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>gender</th>
      <th>age</th>
      <th>hypertension</th>
      <th>heart_disease</th>
      <th>ever_married</th>
      <th>work_type</th>
      <th>Residence_type</th>
      <th>avg_glucose_level</th>
      <th>bmi</th>
      <th>smoking_status</th>
      <th>stroke</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>9046</td>
      <td>Male</td>
      <td>67.0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>228.69</td>
      <td>36.6</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>51676</td>
      <td>Female</td>
      <td>61.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>202.21</td>
      <td>NaN</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>31112</td>
      <td>Male</td>
      <td>80.0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>105.92</td>
      <td>32.5</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>60182</td>
      <td>Female</td>
      <td>49.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>171.23</td>
      <td>34.4</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1665</td>
      <td>Female</td>
      <td>79.0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>174.12</td>
      <td>24.0</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell markdown">
<p>Here, we see the data type of each attribute. In order for us to effectively and more easily analyze the dataset, we changed Ever Married to 1's and 0's, Work Type to 0's, 1's and 2's, Residence Type to 1's and 0's, and Smoking Status to 0's, 1's, 2's and 3's, to represent each attributes respective objects.</p>
</div>
<section id="data-quality" class="cell markdown">
<h2>Data Quality</h2>
</section>
<div class="cell code" data-execution_count="5">
<div class="sourceCode" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.info())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 5110 entries, 0 to 5109
Data columns (total 12 columns):
 #   Column             Non-Null Count  Dtype  
---  ------             --------------  -----  
 0   id                 5110 non-null   int64  
 1   gender             5110 non-null   object 
 2   age                5110 non-null   float64
 3   hypertension       5110 non-null   int64  
 4   heart_disease      5110 non-null   int64  
 5   ever_married       5110 non-null   int64  
 6   work_type          5110 non-null   object 
 7   Residence_type     5110 non-null   int64  
 8   avg_glucose_level  5110 non-null   float64
 9   bmi                4909 non-null   float64
 10  smoking_status     5110 non-null   int64  
 11  stroke             5110 non-null   int64  
dtypes: float64(3), int64(7), object(2)
memory usage: 479.2+ KB
None
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>From first glance, we are able to notice that out of 5110 instances, the BMI attribute is missing 201 instances. We do not consider these to be mistakes but rather a simple inability to record BMI at the time of evaluation. We decided that, instead of ridding our dataset of those 201 instances using elimination, we would rather impute the BMI values based on its calculable relation to age, gender, glucose levels and hypertension, as opposed to dropping four percent of our dataset.</p>
<p>Additionally, it is important to consider the possibility of duplicate entries, which our ID attribute can assist us with.</p>
</div>
<div class="cell code" data-execution_count="6">
<div class="sourceCode" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>idx <span class="op">=</span> df.duplicated()</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(df[idx])</span></code></pre></div>
<div class="output execute_result" data-execution_count="6">
<pre><code>0</code></pre>
</div>
</div>
<section id="imputation-of-missing-bmi-values" class="cell markdown">
<h2>Imputation of Missing BMI Values</h2>
</section>
<div class="cell code" data-execution_count="7">
<div class="sourceCode" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>warnings.simplefilter(<span class="st">&#39;ignore&#39;</span>, )</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> missingno <span class="im">as</span> mn</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>mn.matrix(df)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;Not Sorted&quot;</span>, fontsize<span class="op">=</span><span class="dv">22</span>)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>mn.matrix(df.sort_values(by<span class="op">=</span>[<span class="st">&quot;bmi&quot;</span>]))</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;Sorted&quot;</span>, fontsize<span class="op">=</span><span class="dv">22</span>)</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_e2105a01bf5e4062bcb04e1b4f9ee08a/2391867efc25597a586b2c5f36ed296e8e3c6639.png" /></p>
</div>
<div class="output display_data">
<pre><code>&lt;Figure size 432x288 with 0 Axes&gt;</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_e2105a01bf5e4062bcb04e1b4f9ee08a/b0533ffd1ce273d58810bd789fcba2952d4e518b.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="8">
<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Removing irrelevant attributes </span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> [<span class="st">&#39;id&#39;</span>, <span class="st">&#39;work_type&#39;</span>, <span class="st">&#39;Residence_type&#39;</span>]:</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> col <span class="kw">in</span> df:</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> df[col]</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>df.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 5110 entries, 0 to 5109
Data columns (total 9 columns):
 #   Column             Non-Null Count  Dtype  
---  ------             --------------  -----  
 0   gender             5110 non-null   object 
 1   age                5110 non-null   float64
 2   hypertension       5110 non-null   int64  
 3   heart_disease      5110 non-null   int64  
 4   ever_married       5110 non-null   int64  
 5   avg_glucose_level  5110 non-null   float64
 6   bmi                4909 non-null   float64
 7   smoking_status     5110 non-null   int64  
 8   stroke             5110 non-null   int64  
dtypes: float64(3), int64(5), object(1)
memory usage: 359.4+ KB
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="9" data-scrolled="true">
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#impute missing BMI values using Split-Impute-Combine method</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co">#bmi is suspected to by imputed according to their relation to heart disease, hypertension, glucose, and age </span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>df_grouped <span class="op">=</span> df.groupby(by<span class="op">=</span>[<span class="st">&#39;heart_disease&#39;</span>, <span class="st">&#39;hypertension&#39;</span>, <span class="st">&#39;avg_glucose_level&#39;</span>, <span class="st">&#39;age&#39;</span>, <span class="st">&#39;ever_married&#39;</span>])</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>func <span class="op">=</span> <span class="kw">lambda</span> grp: grp.fillna(grp.mean())</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>numeric_columns <span class="op">=</span> [<span class="st">&#39;age&#39;</span>, <span class="st">&#39;hypertension&#39;</span>, <span class="st">&#39;heart_disease&#39;</span>, <span class="st">&#39;avg_glucose_level&#39;</span>, <span class="st">&#39;bmi&#39;</span>, <span class="st">&#39;stroke&#39;</span>]</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>df_imputed_sic <span class="op">=</span> df_grouped[numeric_columns].transform(func)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>col_deleted <span class="op">=</span> <span class="bu">list</span>( <span class="bu">set</span>(df.columns) <span class="op">-</span> <span class="bu">set</span>(df_imputed_sic.columns))</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>df_imputed_sic[col_deleted] <span class="op">=</span> df[col_deleted]</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>df_imputed_sic.dropna(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>df_imputed_sic.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 4909 entries, 0 to 5109
Data columns (total 9 columns):
 #   Column             Non-Null Count  Dtype  
---  ------             --------------  -----  
 0   age                4909 non-null   float64
 1   hypertension       4909 non-null   int64  
 2   heart_disease      4909 non-null   int64  
 3   avg_glucose_level  4909 non-null   float64
 4   bmi                4909 non-null   float64
 5   stroke             4909 non-null   int64  
 6   smoking_status     4909 non-null   int64  
 7   ever_married       4909 non-null   int64  
 8   gender             4909 non-null   object 
dtypes: float64(3), int64(5), object(1)
memory usage: 383.5+ KB
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="10">
<div class="sourceCode" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.impute <span class="im">import</span> KNNImputer </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> copy </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>knn_obj <span class="op">=</span> KNNImputer(n_neighbors<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>features_to_use <span class="op">=</span> [<span class="st">&#39;age&#39;</span>, <span class="st">&#39;hypertension&#39;</span>, <span class="st">&#39;heart_disease&#39;</span>, <span class="st">&#39;avg_glucose_level&#39;</span>, <span class="st">&#39;bmi&#39;</span>, <span class="st">&#39;stroke&#39;</span>]</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>temp <span class="op">=</span> df[features_to_use].to_numpy()</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>knn_obj.fit(temp)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>temp_imputed <span class="op">=</span> knn_obj.transform(temp)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>df_imputed <span class="op">=</span> copy.deepcopy(df)</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>df_imputed[features_to_use] <span class="op">=</span> temp_imputed</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>df_imputed.dropna(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>df_imputed.info()</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 5110 entries, 0 to 5109
Data columns (total 9 columns):
 #   Column             Non-Null Count  Dtype  
---  ------             --------------  -----  
 0   gender             5110 non-null   object 
 1   age                5110 non-null   float64
 2   hypertension       5110 non-null   float64
 3   heart_disease      5110 non-null   float64
 4   ever_married       5110 non-null   int64  
 5   avg_glucose_level  5110 non-null   float64
 6   bmi                5110 non-null   float64
 7   smoking_status     5110 non-null   int64  
 8   stroke             5110 non-null   float64
dtypes: float64(6), int64(2), object(1)
memory usage: 359.4+ KB
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="11">
<div class="sourceCode" id="cb19"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">16</span>,<span class="dv">5</span>))</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>bin_num <span class="op">=</span> <span class="dv">30</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>df_imputed_sic.bmi.plot(kind<span class="op">=</span><span class="st">&#39;hist&#39;</span>, alpha<span class="op">=</span><span class="fl">0.25</span>, label<span class="op">=</span><span class="st">&quot;Split-Impute-Combine&quot;</span>, bins<span class="op">=</span>bin_num)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>df.bmi.plot(kind<span class="op">=</span><span class="st">&#39;hist&#39;</span>, alpha<span class="op">=</span><span class="fl">0.25</span>, label<span class="op">=</span><span class="st">&quot;Orignal&quot;</span>, bins<span class="op">=</span>bin_num)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>plt.ylim([<span class="dv">0</span>,<span class="dv">900</span>])</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>df_imputed.bmi.plot(kind<span class="op">=</span><span class="st">&#39;hist&#39;</span>, alpha<span class="op">=</span><span class="fl">0.25</span>, label<span class="op">=</span><span class="st">&quot;KNN-Imputer&quot;</span>, bins<span class="op">=</span>bin_num)</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>df.bmi.plot(kind<span class="op">=</span><span class="st">&#39;hist&#39;</span>, alpha<span class="op">=</span><span class="fl">0.25</span>, label<span class="op">=</span><span class="st">&quot;Original&quot;</span>, bins<span class="op">=</span>bin_num)</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>plt.ylim([<span class="dv">0</span>,<span class="dv">900</span>])</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_e2105a01bf5e4062bcb04e1b4f9ee08a/bfbe69f17ae72f151f31b15b7f0ef2f4614e3882.png" /></p>
</div>
</div>
<div class="cell markdown">
<p>After running both the SIC and Nth Nearest Neighbor Methods to impute the missing body mass index values, histogram results of both methods show clearly that the imputed values are better represented in the KNN distribution. The value for K was chosen to be 5 and all missing values were able to be imputed where in the SIC method deleted nearly 200 values.</p>
</div>
<div class="cell code" data-execution_count="12">
<div class="sourceCode" id="cb20"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#What percentage of people had a stroke </span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="bu">sum</span>(df.stroke<span class="op">==</span><span class="dv">1</span>)<span class="op">/</span><span class="bu">len</span>(df)<span class="op">*</span><span class="fl">100.0</span></span></code></pre></div>
<div class="output execute_result" data-execution_count="12">
<pre><code>4.87279843444227</code></pre>
</div>
</div>
<section id="data-visualization" class="cell markdown">
<h1>Data Visualization</h1>
</section>
<div class="cell code" data-execution_count="13">
<div class="sourceCode" id="cb22"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>plt.subplots(figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">5</span>))</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>sb.violinplot(x<span class="op">=</span><span class="st">&quot;gender&quot;</span>, y<span class="op">=</span><span class="st">&quot;bmi&quot;</span>, hue<span class="op">=</span><span class="st">&quot;stroke&quot;</span>, data<span class="op">=</span>df_imputed)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;BMI by gender&#39;</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>sb.swarmplot(x<span class="op">=</span><span class="st">&quot;gender&quot;</span>, y<span class="op">=</span><span class="st">&quot;bmi&quot;</span>, hue<span class="op">=</span><span class="st">&quot;stroke&quot;</span>, data<span class="op">=</span>df_imputed)</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;BMI by gender&#39;</span>)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_e2105a01bf5e4062bcb04e1b4f9ee08a/46b3eff9d61a3531426674cfce3d59931fa9f659.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="14">
<div class="sourceCode" id="cb23"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>plt.subplots(figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">5</span>))</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>sb.boxplot(x<span class="op">=</span><span class="st">&quot;gender&quot;</span>, y<span class="op">=</span><span class="st">&quot;age&quot;</span>, hue<span class="op">=</span><span class="st">&quot;stroke&quot;</span>, data<span class="op">=</span>df_imputed)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Age by Gender Box&#39;</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>sb.violinplot(x<span class="op">=</span><span class="st">&quot;gender&quot;</span>, y<span class="op">=</span><span class="st">&quot;age&quot;</span>, hue<span class="op">=</span><span class="st">&quot;stroke&quot;</span>, data<span class="op">=</span>df_imputed)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Age by Gender Violin&#39;</span>)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>sb.swarmplot(x<span class="op">=</span><span class="st">&quot;gender&quot;</span>, y<span class="op">=</span><span class="st">&quot;age&quot;</span>, hue<span class="op">=</span><span class="st">&quot;stroke&quot;</span>, data<span class="op">=</span>df_imputed)</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Age by Gender Swarm&#39;</span>)</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_e2105a01bf5e4062bcb04e1b4f9ee08a/0e66cd89a1b0ebe0356ed137f545c5d36bb268e8.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="15">
<div class="sourceCode" id="cb24"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>sb.histplot(df_imputed.age, kde<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_e2105a01bf5e4062bcb04e1b4f9ee08a/d1c3a094718d3ccdf239ca1d575aaf5c17c2f50b.png" /></p>
</div>
</div>
<section id="hypertension-versus-stroke-incedence" class="cell markdown">
<h1>Hypertension versus Stroke Incedence</h1>
</section>
<div class="cell code" data-execution_count="16">
<div class="sourceCode" id="cb25"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">#What is the breakdown of people who suffer from hypertension. </span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>df_grouped_hyp <span class="op">=</span> df.groupby(by<span class="op">=</span><span class="st">&#39;hypertension&#39;</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> val,grp <span class="kw">in</span> df_grouped_hyp:</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> val <span class="op">==</span> <span class="va">True</span>: </span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&#39;There were </span><span class="sc">{</span><span class="bu">len</span>(grp)<span class="sc">}</span><span class="ss"> people that have hypertenion&#39;</span>)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> val <span class="op">==</span> <span class="va">False</span>: </span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&#39;There were </span><span class="sc">{</span><span class="bu">len</span>(grp)<span class="sc">}</span><span class="ss"> people that dont have hypertension&#39;</span>)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>        </span></code></pre></div>
<div class="output stream stdout">
<pre><code>There were 4612 people that dont have hypertension
There were 498 people that have hypertenion
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="17">
<div class="sourceCode" id="cb27"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co">#correlation Plot </span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>vars_to_use <span class="op">=</span> [<span class="st">&#39;age&#39;</span>, <span class="st">&#39;hypertension&#39;</span>, <span class="st">&#39;heart_disease&#39;</span>, <span class="st">&#39;avg_glucose_level&#39;</span>, <span class="st">&#39;bmi&#39;</span>, <span class="st">&#39;stroke&#39;</span>, <span class="st">&#39;ever_married&#39;</span>, <span class="st">&#39;smoking_status&#39;</span>]</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>plt.pcolor(df_imputed[vars_to_use].corr())</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>plt.yticks(np.arange(<span class="fl">0.5</span>, <span class="bu">len</span>(vars_to_use), <span class="dv">1</span>), vars_to_use)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>plt.xticks(np.arange(<span class="fl">0.5</span>, <span class="bu">len</span>(vars_to_use), <span class="dv">1</span>), vars_to_use)</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>plt.colorbar()</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_e2105a01bf5e4062bcb04e1b4f9ee08a/6f440f81d4fb6fce3e63098c6fdaf7b8477d56db.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="18" data-scrolled="true">
<div class="sourceCode" id="cb28"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>cmap <span class="op">=</span> sb.<span class="bu">set</span>()</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>f, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">8</span>,<span class="dv">8</span>))</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>sb.heatmap(df_imputed.corr(), cmap<span class="op">=</span>cmap, annot<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="18">
<pre><code>&lt;AxesSubplot:&gt;</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_e2105a01bf5e4062bcb04e1b4f9ee08a/34ffc07ea108f04da4bbdfe0578449eea719e8cd.png" /></p>
</div>
</div>
<div class="cell markdown">
<p>According to the above correlation matrices, we see that age is by far the msot correlated to the possibility of stroke, followed by a three way tie between hypertension, heart disease, and glucose levels.</p>
</div>
<div class="cell code" data-execution_count="19" data-scrolled="true">
<div class="sourceCode" id="cb30"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Visualization Techniques: Histogram &amp; Kernel Density </span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>warnings.simplefilter(<span class="st">&#39;ignore&#39;</span>, <span class="pp">DeprecationWarning</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>plt.style.use(<span class="st">&#39;ggplot&#39;</span>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>,<span class="dv">5</span>))</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="co">#histogram of the BMI </span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>df_imputed.bmi.plot.hist(bins<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="co">#KDE of the BMI </span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">2</span>)</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>df_imputed.bmi.plot.kde(bw_method<span class="op">=</span><span class="fl">0.2</span>)</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a><span class="co">#Overlapping the Histogram and KDE </span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>df_imputed.bmi.plot.hist(bins<span class="op">=</span><span class="dv">40</span>)</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>df_imputed.bmi.plot.kde(bw_method<span class="op">=</span><span class="fl">0.04</span>, secondary_y<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_e2105a01bf5e4062bcb04e1b4f9ee08a/5c0431c8e06cf12cad1ed485dbb2aa18e827e432.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="20" data-scrolled="true">
<div class="sourceCode" id="cb31"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Two-Dimensional Analysis of BMI with BMI and Stroke </span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>plt.hist2d(x<span class="op">=</span>df_imputed.bmi, y<span class="op">=</span>df_imputed.stroke, bins<span class="op">=</span><span class="dv">30</span>)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>plt.colorbar()</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;BMI&#39;</span>)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Stroke&#39;</span>)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_e2105a01bf5e4062bcb04e1b4f9ee08a/3b430e894147dd66faa095a495d0df34494d5902.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="21" data-scrolled="false">
<div class="sourceCode" id="cb32"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Two-Dimensional Analysis of Glucose Level with Glucose Level and Stroke </span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>plt.hist2d(x<span class="op">=</span>df_imputed.avg_glucose_level, y<span class="op">=</span>df_imputed.stroke, bins<span class="op">=</span><span class="dv">30</span>)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>plt.colorbar()</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Glucose Level&#39;</span>)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Stroke&#39;</span>)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_e2105a01bf5e4062bcb04e1b4f9ee08a/0383a583b03b6fa93dd7c182ade7fc29ac92a2f8.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="22" data-scrolled="false">
<div class="sourceCode" id="cb33"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Two-Dimensional Analysis of BMI with Age and Stroke </span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>plt.hist2d(x<span class="op">=</span>df_imputed.age, y<span class="op">=</span>df_imputed.stroke, bins<span class="op">=</span><span class="dv">30</span>)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>plt.colorbar()</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Age&#39;</span>)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Stroke&#39;</span>)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_e2105a01bf5e4062bcb04e1b4f9ee08a/4984f6c4e222843276656ae51fc8edf4ddbe599f.png" /></p>
</div>
</div>
<section id="discretization-of-continuous-values" class="cell markdown">
<h2>Discretization of Continuous Values</h2>
</section>
<div class="cell code" data-execution_count="23">
<div class="sourceCode" id="cb34"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">#We need to feature Discretization of BMI, Age, and Glucose Level  </span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>df_imputed[<span class="st">&#39;age_range&#39;</span>] <span class="op">=</span> pd.cut(df_imputed[<span class="st">&#39;age&#39;</span>],</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>                                [<span class="dv">0</span>,<span class="dv">13</span>,<span class="dv">25</span>,<span class="dv">45</span>,<span class="dv">65</span>,<span class="fl">1e6</span>],</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>                                labels<span class="op">=</span>[<span class="st">&#39;toddler&#39;</span>,<span class="st">&#39;child&#39;</span>,<span class="st">&#39;young adult&#39;</span>,</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">&#39;adult&#39;</span>,<span class="st">&#39;senior&#39;</span>])</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>df_imputed.age_range.describe()</span></code></pre></div>
<div class="output execute_result" data-execution_count="23">
<pre><code>count      5110
unique        5
top       adult
freq       1527
Name: age_range, dtype: object</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="24">
<div class="sourceCode" id="cb36"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>df_imputed[<span class="st">&#39;bmi_range&#39;</span>] <span class="op">=</span> pd.cut(df_imputed[<span class="st">&#39;bmi&#39;</span>],</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>                                [<span class="dv">0</span>,<span class="dv">18</span>,<span class="dv">25</span>,<span class="dv">30</span>,<span class="dv">35</span>,<span class="fl">1e6</span>],</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>                                labels<span class="op">=</span>[<span class="st">&#39;underweight&#39;</span>,<span class="st">&#39;normal&#39;</span>,<span class="st">&#39;overweight&#39;</span>,</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">&#39;obese&#39;</span>,<span class="st">&#39;morbidly obese&#39;</span>])</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>df_imputed.bmi_range.describe()</span></code></pre></div>
<div class="output execute_result" data-execution_count="24">
<pre><code>count           5110
unique             5
top       overweight
freq            1484
Name: bmi_range, dtype: object</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="25">
<div class="sourceCode" id="cb38"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>df_imputed[<span class="st">&#39;glucose_range&#39;</span>] <span class="op">=</span> pd.cut(df_imputed[<span class="st">&#39;avg_glucose_level&#39;</span>],</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>                                [<span class="dv">0</span>,<span class="dv">53</span>,<span class="dv">70</span>,<span class="dv">125</span>,<span class="dv">200</span>,<span class="fl">1e6</span>],</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>                                labels<span class="op">=</span>[<span class="st">&#39;severe hypoglycemia&#39;</span>,<span class="st">&#39;hypoglycemia&#39;</span>,<span class="st">&#39;normal&#39;</span>,</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">&#39;prediabetic&#39;</span>,<span class="st">&#39;diabetic&#39;</span>])</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>df_imputed.avg_glucose_level.describe()</span></code></pre></div>
<div class="output execute_result" data-execution_count="25">
<pre><code>count    5110.000000
mean      106.147677
std        45.283560
min        55.120000
25%        77.245000
50%        91.885000
75%       114.090000
max       271.740000
Name: avg_glucose_level, dtype: float64</code></pre>
</div>
</div>
<section id="grouping-of-discrete-features-versus-stroke-incidence" class="cell markdown">
<h2>Grouping of Discrete Features versus Stroke Incidence</h2>
</section>
<div class="cell code" data-execution_count="26">
<div class="sourceCode" id="cb40"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Group these with their stroke categories </span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>df_grouped <span class="op">=</span> df_imputed.groupby(by<span class="op">=</span>[<span class="st">&#39;bmi_range&#39;</span>,<span class="st">&#39;age_range&#39;</span>])</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Percentage of Stoke Status in Each Group:&#39;</span>)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_grouped.stroke.<span class="bu">sum</span>() <span class="op">/</span> df_grouped.stroke.count()<span class="op">*</span><span class="dv">100</span>)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="co">#df_grouped.stroke.count()</span></span></code></pre></div>
<div class="output stream stdout">
<pre><code>Percentage of Stoke Status in Each Group:
bmi_range       age_range  
underweight     toddler         0.393701
                child           0.000000
                young adult     0.000000
                adult           0.000000
                senior         10.000000
normal          toddler         0.000000
                child           0.000000
                young adult     0.324675
                adult           1.746725
                senior         18.539326
overweight      toddler         0.000000
                child           0.000000
                young adult     1.500000
                adult           5.144033
                senior         17.539267
obese           toddler         0.000000
                child           1.219512
                young adult     0.358423
                adult           6.142506
                senior         14.652015
morbidly obese  toddler         0.000000
                child           0.000000
                young adult     0.906344
                adult           6.532663
                senior         12.295082
Name: stroke, dtype: float64
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="27">
<div class="sourceCode" id="cb42"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>df_grouped <span class="op">=</span> df_imputed.groupby(by<span class="op">=</span>[<span class="st">&#39;glucose_range&#39;</span>,<span class="st">&#39;age_range&#39;</span>])</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Percentage of Stoke Status in Each Group:&#39;</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_grouped.stroke.<span class="bu">sum</span>() <span class="op">/</span> df_grouped.stroke.count()<span class="op">*</span><span class="dv">100</span>)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>df_grouped.stroke.count()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Percentage of Stoke Status in Each Group:
glucose_range        age_range  
severe hypoglycemia  toddler              NaN
                     child                NaN
                     young adult          NaN
                     adult                NaN
                     senior               NaN
hypoglycemia         toddler         0.000000
                     child           0.952381
                     young adult     1.025641
                     adult           3.125000
                     senior         13.600000
normal               toddler         0.211416
                     child           0.000000
                     young adult     0.728408
                     adult           4.628633
                     senior         13.601533
prediabetic          toddler         0.000000
                     child           0.000000
                     young adult     0.833333
                     adult           6.598985
                     senior         25.000000
diabetic             toddler         0.000000
                     child           0.000000
                     young adult     2.040816
                     adult           9.604520
                     senior         19.191919
Name: stroke, dtype: float64
</code></pre>
</div>
<div class="output execute_result" data-execution_count="27">
<pre><code>glucose_range        age_range  
severe hypoglycemia  toddler          0
                     child            0
                     young adult      0
                     adult            0
                     senior           0
hypoglycemia         toddler        107
                     child          105
                     young adult    195
                     adult          224
                     senior         125
normal               toddler        473
                     child          469
                     young adult    961
                     adult          929
                     senior         522
prediabetic          toddler         60
                     child           69
                     young adult    120
                     adult          197
                     senior         120
diabetic             toddler          5
                     child            5
                     young adult     49
                     adult          177
                     senior         198
Name: stroke, dtype: int64</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="28">
<div class="sourceCode" id="cb45"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>df_grouped <span class="op">=</span> df_imputed.groupby(by<span class="op">=</span>[<span class="st">&#39;smoking_status&#39;</span>,<span class="st">&#39;age_range&#39;</span>])</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Percentage of Stoke Status in Each Group:&#39;</span>)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_grouped.stroke.<span class="bu">sum</span>() <span class="op">/</span> df_grouped.stroke.count()<span class="op">*</span><span class="dv">100</span>)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>df_grouped.stroke.count()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Percentage of Stoke Status in Each Group:
smoking_status  age_range  
0               toddler         0.000000
                child           0.000000
                young adult     0.528169
                adult           3.553299
                senior         17.054264
1               toddler         0.000000
                child           0.000000
                young adult     1.554404
                adult           6.321839
                senior         15.957447
2               toddler         0.000000
                child           0.000000
                young adult     1.041667
                adult           7.260726
                senior         14.655172
3               toddler         0.170940
                child           0.458716
                young adult     0.724638
                adult           5.263158
                senior         15.555556
Name: stroke, dtype: float64
</code></pre>
</div>
<div class="output execute_result" data-execution_count="28">
<pre><code>smoking_status  age_range  
0               toddler         45
                child          301
                young adult    568
                adult          591
                senior         387
1               toddler         12
                child           50
                young adult    193
                adult          348
                senior         282
2               toddler          3
                child           79
                young adult    288
                adult          303
                senior         116
3               toddler        585
                child          218
                young adult    276
                adult          285
                senior         180
Name: stroke, dtype: int64</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="29" data-scrolled="true">
<div class="sourceCode" id="cb48"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_grouped_hyp[<span class="st">&#39;stroke&#39;</span>].<span class="bu">sum</span>())</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;---------------------------------&#39;</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_grouped_hyp.stroke.count())</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;---------------------------------&#39;</span>)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_grouped_hyp.stroke.<span class="bu">sum</span>()<span class="op">/</span> df_grouped_hyp.stroke.count())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>hypertension
0    183
1     66
Name: stroke, dtype: int64
---------------------------------
hypertension
0    4612
1     498
Name: stroke, dtype: int64
---------------------------------
hypertension
0    0.039679
1    0.132530
Name: stroke, dtype: float64
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="30">
<div class="sourceCode" id="cb50"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>more_likely_ratio <span class="op">=</span> <span class="fl">0.132530</span><span class="op">/</span><span class="fl">0.039679</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(more_likely_ratio)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>3.340053932810807
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>According to our hyptension grouped data, those with hypertension are 3.3 time more likely to have a stroke when compared to those aren't diagnosed with hypertension.</p>
</div>
<section id="heart-disease-versus-stroke-incidence" class="cell markdown">
<h1>Heart Disease versus Stroke Incidence</h1>
</section>
<div class="cell code" data-execution_count="31">
<div class="sourceCode" id="cb52"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co">#What is the breakdown of people who suffer from heart disease. </span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>df_grouped_hd <span class="op">=</span> df.groupby(by<span class="op">=</span><span class="st">&#39;heart_disease&#39;</span>)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> val,grp <span class="kw">in</span> df_grouped_hd:</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> val <span class="op">==</span> <span class="va">True</span>: </span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&#39;There were </span><span class="sc">{</span><span class="bu">len</span>(grp)<span class="sc">}</span><span class="ss"> people that are diagnosed with heart disease&#39;</span>)</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> val <span class="op">==</span> <span class="va">False</span>: </span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&#39;There were </span><span class="sc">{</span><span class="bu">len</span>(grp)<span class="sc">}</span><span class="ss"> people that are not diagnosed with heart disease&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>There were 4834 people that are not diagnosed with heart disease
There were 276 people that are diagnosed with heart disease
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="32">
<div class="sourceCode" id="cb54"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_grouped_hd[<span class="st">&#39;stroke&#39;</span>].<span class="bu">sum</span>())</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;---------------------------------&#39;</span>)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_grouped_hd.stroke.count())</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;---------------------------------&#39;</span>)</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_grouped_hd.stroke.<span class="bu">sum</span>()<span class="op">/</span> df_grouped_hd.stroke.count())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>heart_disease
0    202
1     47
Name: stroke, dtype: int64
---------------------------------
heart_disease
0    4834
1     276
Name: stroke, dtype: int64
---------------------------------
heart_disease
0    0.041787
1    0.170290
Name: stroke, dtype: float64
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="33" data-scrolled="true">
<div class="sourceCode" id="cb56"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>more_likely_ratio <span class="op">=</span> <span class="fl">0.170290</span><span class="op">/</span><span class="fl">0.041787</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(more_likely_ratio)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>4.0751908488285835
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>According to our hyptension grouped data, those with heart diease are 4 time more likely to have a stroke when compared to those aren't diagnosed with hypertension.</p>
</div>
<section id="marriage-history-versus-stroke-incidence" class="cell markdown">
<h1>Marriage History versus Stroke Incidence</h1>
</section>
<div class="cell code" data-execution_count="34">
<div class="sourceCode" id="cb58"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co">#What is the breakdown of people who have ever been married. </span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>df_grouped_mar <span class="op">=</span> df.groupby(by<span class="op">=</span><span class="st">&#39;ever_married&#39;</span>)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> val,grp <span class="kw">in</span> df_grouped_mar: </span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> val <span class="op">==</span> <span class="st">&#39;Yes&#39;</span>:</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&#39;There were </span><span class="sc">{</span><span class="bu">len</span>(grp)<span class="sc">}</span><span class="ss"> people that have been married&#39;</span>)</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> val <span class="op">==</span> <span class="st">&#39;No&#39;</span>: </span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&#39;There were </span><span class="sc">{</span><span class="bu">len</span>(grp)<span class="sc">}</span><span class="ss"> people that have not ever been married&#39;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="35" data-scrolled="false">
<div class="sourceCode" id="cb59"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_grouped_mar[<span class="st">&#39;stroke&#39;</span>].<span class="bu">sum</span>())</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;---------------------------------&#39;</span>)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_grouped_mar.stroke.count())</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;---------------------------------&#39;</span>)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_grouped_mar.stroke.<span class="bu">sum</span>()<span class="op">/</span> df_grouped_mar.stroke.count())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>ever_married
0     29
1    220
Name: stroke, dtype: int64
---------------------------------
ever_married
0    1757
1    3353
Name: stroke, dtype: int64
---------------------------------
ever_married
0    0.016505
1    0.065613
Name: stroke, dtype: float64
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="36">
<div class="sourceCode" id="cb61"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>more_likely_ratio <span class="op">=</span> <span class="fl">0.065613</span><span class="op">/</span><span class="fl">0.016505</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(more_likely_ratio)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>3.97534080581642
</code></pre>
</div>
</div>
<div class="cell markdown">
<p>According to our hyptension grouped data, those who have been married are 4 time more likely to have a stroke when compared to those who haven't ever been married.</p>
</div>
<section id="categorical-visualizations" class="cell markdown">
<h1>Categorical Visualizations</h1>
</section>
<div class="cell code" data-execution_count="37">
<div class="sourceCode" id="cb63"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Grouped Count Stoke Plots </span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="co">#The three subplots will be of Age, BMI, and Heart Disease </span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>,<span class="dv">3</span>))</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>ax1 <span class="op">=</span> plt.subplot(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> plt.subplot(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">2</span>)</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>ax3 <span class="op">=</span> plt.subplot(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>pd.crosstab([df_imputed[<span class="st">&#39;age_range&#39;</span>]],</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>           df_imputed.stroke.astype(<span class="bu">bool</span>)).plot(kind<span class="op">=</span><span class="st">&#39;bar&#39;</span>, stacked<span class="op">=</span><span class="va">True</span>, ax<span class="op">=</span>ax1)</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>pd.crosstab([df_imputed[<span class="st">&#39;bmi_range&#39;</span>]],</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>           df_imputed.stroke.astype(<span class="bu">bool</span>)).plot(kind<span class="op">=</span><span class="st">&#39;bar&#39;</span>, stacked<span class="op">=</span><span class="va">True</span>, ax<span class="op">=</span>ax2)</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>pd.crosstab([df_imputed[<span class="st">&#39;glucose_range&#39;</span>]],</span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>           df_imputed.stroke.astype(<span class="bu">bool</span>)).plot(kind<span class="op">=</span><span class="st">&#39;bar&#39;</span>, stacked<span class="op">=</span><span class="va">True</span>, ax<span class="op">=</span>ax3)</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_e2105a01bf5e4062bcb04e1b4f9ee08a/9ec181e4d21cdcc535988dd08f1f1aedef81f06c.png" /></p>
</div>
</div>
<div class="cell markdown">
<p>From grouped stroke plots, it is evident that age is the more significant feature when dividng its range into discrete intervals. The BMI grouped data also shows a trend in the ranges that exceed overweight. On the other hand, the plot for average glucose value is less conclusive.</p>
</div>
<div class="cell code" data-execution_count="38">
<div class="sourceCode" id="cb64"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Grouped Count Stoke Plots </span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="co">#The three subplots will be of Hypertension, Heart Disease, and Marriage History </span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>,<span class="dv">3</span>))</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>ax1 <span class="op">=</span> plt.subplot(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>ax2 <span class="op">=</span> plt.subplot(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">2</span>)</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>ax3 <span class="op">=</span> plt.subplot(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>pd.crosstab([df_imputed[<span class="st">&#39;hypertension&#39;</span>]],</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>           df_imputed.stroke.astype(<span class="bu">bool</span>)).plot(kind<span class="op">=</span><span class="st">&#39;bar&#39;</span>, stacked<span class="op">=</span><span class="va">True</span>, ax<span class="op">=</span>ax1)</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>pd.crosstab([df_imputed[<span class="st">&#39;heart_disease&#39;</span>]],</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>           df_imputed.stroke.astype(<span class="bu">bool</span>)).plot(kind<span class="op">=</span><span class="st">&#39;bar&#39;</span>, stacked<span class="op">=</span><span class="va">True</span>, ax<span class="op">=</span>ax2)</span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>pd.crosstab([df_imputed[<span class="st">&#39;ever_married&#39;</span>]],</span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a>           df_imputed.stroke.astype(<span class="bu">bool</span>)).plot(kind<span class="op">=</span><span class="st">&#39;bar&#39;</span>, stacked<span class="op">=</span><span class="va">True</span>, ax<span class="op">=</span>ax3)</span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_e2105a01bf5e4062bcb04e1b4f9ee08a/f8202ef4d4e2ca952267804dde26914f5f9103fc.png" /></p>
</div>
</div>
<div class="cell markdown">
<p>The grouped stroke count plots for the binary data interestingly shows the those who have been married have a much higher incidence of stroke.</p>
</div>
<div class="cell code" data-execution_count="39" data-scrolled="true">
<div class="sourceCode" id="cb65"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">&#39;stroke.csv&#39;</span>)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>pd.get_dummies(df.smoking_status)</span></code></pre></div>
<div class="output execute_result" data-execution_count="39">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unknown</th>
      <th>formerly smoked</th>
      <th>never smoked</th>
      <th>smokes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>5105</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5106</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5107</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5108</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5109</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5110 rows  4 columns</p>
</div>
</div>
</div>
<div class="cell code" data-execution_count="40">
<div class="sourceCode" id="cb66"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>,<span class="dv">3</span>))</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>ax1 <span class="op">=</span> plt.subplot(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>pd.crosstab([df.smoking_status],</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>           df.stroke.astype(<span class="bu">bool</span>)).plot(kind<span class="op">=</span><span class="st">&#39;bar&#39;</span>, stacked<span class="op">=</span><span class="va">False</span>, ax<span class="op">=</span>ax1)</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>plt.yscale(<span class="st">&quot;log&quot;</span>)</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_e2105a01bf5e4062bcb04e1b4f9ee08a/a9de968b47d97c7c64928bb84395a6947d68e325.png" /></p>
</div>
</div>
<section id="dimensionality-reduction" class="cell markdown">
<h1>Dimensionality Reduction</h1>
</section>
<div class="cell code" data-execution_count="41">
<div class="sourceCode" id="cb67"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.datasets <span class="im">import</span> load_digits</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>sb.<span class="bu">set</span>(style<span class="op">=</span><span class="st">&#39;white&#39;</span>, context<span class="op">=</span><span class="st">&#39;poster&#39;</span>, rc<span class="op">=</span>{<span class="st">&#39;figure.figsize&#39;</span>:(<span class="dv">14</span>,<span class="dv">10</span>)})</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>stroke <span class="op">=</span> pd.read_csv(<span class="st">&#39;stroke.csv&#39;</span>)</span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>stroke <span class="op">=</span> stroke.dropna()</span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>sns.pairplot(stroke, hue<span class="op">=</span><span class="st">&#39;smoking_status&#39;</span>)</span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> umap.umap_ <span class="im">as</span> umap </span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a>reducer <span class="op">=</span> umap.UMAP()</span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a>stroke_data <span class="op">=</span> stroke[</span>
<span id="cb67-21"><a href="#cb67-21" aria-hidden="true" tabindex="-1"></a>    [</span>
<span id="cb67-22"><a href="#cb67-22" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;age&quot;</span>,</span>
<span id="cb67-23"><a href="#cb67-23" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;avg_glucose_level&quot;</span>,</span>
<span id="cb67-24"><a href="#cb67-24" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;bmi&quot;</span>,</span>
<span id="cb67-25"><a href="#cb67-25" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;stroke&quot;</span>,</span>
<span id="cb67-26"><a href="#cb67-26" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb67-27"><a href="#cb67-27" aria-hidden="true" tabindex="-1"></a>].values</span>
<span id="cb67-28"><a href="#cb67-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-29"><a href="#cb67-29" aria-hidden="true" tabindex="-1"></a>scaled_stroke_data <span class="op">=</span> StandardScaler().fit_transform(stroke_data)</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_e2105a01bf5e4062bcb04e1b4f9ee08a/fbc478f91c2ef3dc94fd180da0223241631c8313.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="42">
<div class="sourceCode" id="cb68"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>embedding <span class="op">=</span> reducer.fit_transform(scaled_stroke_data)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>embedding.shape</span></code></pre></div>
<div class="output execute_result" data-execution_count="42">
<pre><code>(4909, 2)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="43">
<div class="sourceCode" id="cb70"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>plt.scatter(</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>    embedding[:, <span class="dv">0</span>],</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>    embedding[:, <span class="dv">1</span>],</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>    c<span class="op">=</span>stroke.age, cmap <span class="op">=</span> <span class="st">&quot;Spectral&quot;</span>, label<span class="op">=</span>np.unique(stroke.smoking_status), s<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>plt.gca().set_aspect(<span class="st">&#39;equal&#39;</span>, <span class="st">&#39;datalim&#39;</span>)</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;UMAP projection of the Stroke Dataset&#39;</span>, fontsize<span class="op">=</span><span class="dv">24</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="43">
<pre><code>Text(0.5, 1.0, &#39;UMAP projection of the Stroke Dataset&#39;)</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_e2105a01bf5e4062bcb04e1b4f9ee08a/7fb2b60a56d195bf5be4d64cd583653b370bd2c1.png" /></p>
</div>
</div>
<div class="cell markdown">
<p>Cite: <a href="https://umap-learn.readthedocs.io/en/latest/basic_usage.html" class="uri">https://umap-learn.readthedocs.io/en/latest/basic_usage.html</a></p>
</div>
<div class="cell markdown">
<p>This is an attempt at a dimensionality reduction technique called Uniform Manifold Approximation and Projection. The colormap is in terms of the age. As you can see, the manifold structre has largest cluster of locally connective data where age seems to be a significant parameter.</p>
</div>
<div class="cell code">
<div class="sourceCode" id="cb72"><pre class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
</body>
</html>
